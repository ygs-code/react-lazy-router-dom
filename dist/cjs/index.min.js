/*!
 * react-lazy-router-dom v0.0.2
 * (c) 2022-2023 yao guan shou (姚观寿) 281113270@qq.com
 * Released under the MIT License.
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("prop-types"),e=require("react"),n=require("@babel/runtime/regenerator"),r=require("hoist-non-react-statics");function o(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=o(t),c=o(e),a=o(n),u=o(r);function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){a=!0,i=t},f:function(){try{c||null==n.return||n.return()}finally{if(a)throw i}}}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var y=function t(e){return t.loaderArr=[].concat(f(t.loaderArr),[e]),function(){return e().then((function(t){return t.default})).catch((function(t){throw new Error(t)}))}};y.loaderArr=[];function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}var m=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},h=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function v(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function b(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function g(t,e){return t.keys=e,t}function x(t){return t&&t.sensitive?"":"i"}function S(t,e,n){return function(t,e,n){m(e)||(n=e||n,e=[]);for(var r=(n=n||{}).strict,o=!1!==n.end,i="",c=0;c<t.length;c++){var a=t[c];if("string"==typeof a)i+=v(a);else{var u=v(a.prefix),l="(?:"+a.pattern+")";e.push(a),a.repeat&&(l+="(?:"+u+l+")*"),i+=l=a.optional?a.partial?u+"("+l+")?":"(?:"+u+"("+l+"))?":u+"("+l+")"}}var f=v(n.delimiter||"/"),s=i.slice(-f.length)===f;r||(i=(s?i.slice(0,-f.length):i)+"(?:"+f+"(?=$))?");i+=o?"$":r&&s?"":"(?="+f+"|$)";return g(new RegExp("^"+i,x(n)),e)}(function(t,e){for(var n,r=[],o=0,i=0,c="",a=e&&e.delimiter||"/";null!=(n=h.exec(t));){var u=n[0],l=n[1],f=n.index;if(c+=t.slice(i,f),i=f+u.length,l)c+=l[1];else{var s=t[i],p=n[2],y=n[3],d=n[4],m=n[5],g=n[6],x=n[7];c&&(r.push(c),c="");var S=null!=p&&null!=s&&s!==p,w="+"===g||"*"===g,$="?"===g||"*"===g,j=n[2]||a,C=d||m;r.push({name:y||o++,prefix:p||"",delimiter:j,optional:$,repeat:w,partial:S,asterisk:!!x,pattern:C?b(C):x?".*":"[^"+v(j)+"]+?"})}}return i<t.length&&(c+=t.substr(i)),c&&r.push(c),r}(t,n),e,n)}function w(t,e,n){return m(e)||(n=e||n,e=[]),n=n||{},t instanceof RegExp?function(t,e){var n=t.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)e.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return g(t,e)}(t,e):m(t)?function(t,e,n){for(var r=[],o=0;o<t.length;o++)r.push(w(t[o],e,n).source);return g(new RegExp("(?:"+r.join("|")+")",x(n)),e)}(t,e,n):S(t,e,n)}var $={},j=0,C=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};("string"==typeof e||Array.isArray(e))&&(e={path:e});var n=e,r=n.path,o=void 0!==r&&r,i=n.exact,c=void 0!==i&&i,a=n.strict,u=void 0!==a&&a,l=n.sensitive,f=void 0!==l&&l;return[].concat(o).reduce((function(e,n){if(!n&&""!==n)return null;if(e)return e;var r=function(t,e){var n=""+e.end+e.strict+e.sensitive,r=$[n]||($[n]={});if(r[t])return r[t];var o=[],i={regexp:w(t,o,e),keys:o};return j<1e4&&(r[t]=i,j++),i}(n,{end:c,strict:u,sensitive:f}),o=r.regexp,i=r.keys,a=o.exec(t);if(!a)return null;var l=a[0],s=a.slice(1),p=t===l;return c&&!p?null:{path:n,url:"/"===n&&""===l?"/":l,isExact:p,params:i.reduce((function(t,e,n){return t[e.name]=s[n],t}),{})}}),null)},E=function(t){var n=t.children;return n?e.Children.map(n,(function(n){return e.cloneElement(n,t)})):null};function O(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R(t){var e=function(t,e){if("object"!==d(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===d(e)?e:String(e)}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,R(r.key),r)}}function A(t,e,n){return e&&_(t.prototype,e),n&&_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function P(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k(t,e){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},k(t,e)}function M(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&k(t,e)}function T(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return P(t)}function I(t){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},I(t)}function q(t,e,n){return(e=R(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=I(t);if(e){var o=I(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return T(this,n)}}E.propTypes={component:i.default.oneOfType([i.default.func,i.default.object]).isRequired};var B,L,D=(B="Router",(L=e.createContext()).displayName=B,L),K=function(t){M(r,e.Component);var n=N(r);function r(t){var e;O(this,r),q(P(e=n.call(this,t)),"computeRootMatch",(function(t){return{path:"/",url:"/",params:{},isExact:"/"===t}}));var o=e.props,i=o.history,c=o.staticContext;return e.state={location:i.location},e._isMounted=!1,e._pendingLocation=null,c||(e.unlisten=i.listen((function(t){var n=t.location;e._pendingLocation=n}))),T(e,P(e))}return A(r,[{key:"componentDidMount",value:function(){var t=this;this._isMounted=!0;var e=this.props,n=e.staticContext,r=e.history;this.unlisten&&this.unlisten(),n||(this.unlisten=r.listen((function(e){var n=e.location;t._isMounted&&t.setState({location:n})}))),this._pendingLocation&&this.setState({location:this._pendingLocation})}},{key:"componentWillUnmount",value:function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)}},{key:"render",value:function(){var t=this.props,n=t.children,r=t.staticContext,o=t.loading,i=t.history,c=t.routesComponent,a=this.state.location;return e.createElement(D.Provider,{value:{history:i,location:a,staticContext:r,loading:o,routesComponent:c},children:n?e.Children.only(n):null})}}]),r}();function U(t,e,n,r,o,i,c){try{var a=t[i](c),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,o)}K.propTypes={history:i.default.object.isRequired,staticContext:i.default.object,routesComponent:i.default.array,loading:function(t,e,n){if(!t[e])return new Error("In component ".concat(n," props ").concat(e," type is invalid -- expected a ").concat(e," is component"));try{t[e]}catch(t){return new Error("In component ".concat(n," props ").concat(e," type is invalid -- expected a ").concat(e," is component"))}}};var z="production"===process.env.NODE_ENV,V="Invariant failed";function W(t,e){if(!t){if(z)throw new Error(V);var n="function"==typeof e?e():e,r=n?"".concat(V,": ").concat(n):V;throw new Error(r)}}function Y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=I(t);if(e){var o=I(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return T(this,n)}}var F=function(t){var n=e.createContext();return n.displayName=t,n}("Router-Match"),G=function(t){var e="function"==typeof Symbol&&Symbol.for,n=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,o=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,c=e?Symbol.for("react.profiler"):60114,a=e?Symbol.for("react.provider"):60109,u=e?Symbol.for("react.context"):60110,l=e?Symbol.for("react.async_mode"):60111,f=e?Symbol.for("react.concurrent_mode"):60111,s=e?Symbol.for("react.forward_ref"):60112,p=e?Symbol.for("react.suspense"):60113,y=e?Symbol.for("react.suspense_list"):60120,m=e?Symbol.for("react.memo"):60115,h=e?Symbol.for("react.lazy"):60116,v=e?Symbol.for("react.block"):60121,b=e?Symbol.for("react.fundamental"):60117,g=e?Symbol.for("react.responder"):60118,x=e?Symbol.for("react.scope"):60119;return t===o||t===f||t===c||t===i||t===p||t===y||"object"===d(t)&&null!==t&&(t.$$typeof===o||t.$$typeof===f||t.$$typeof===c||t.$$typeof===i||t.$$typeof===p||t.$$typeof===y||t.$$typeof===n||t.$$typeof===l||t.$$typeof===r||t.$$typeof===h||t.$$typeof===m||t.$$typeof===a||t.$$typeof===u||t.$$typeof===s||t.$$typeof===b||t.$$typeof===g||t.$$typeof===x||t.$$typeof===v)},H=function(){return c.default.createElement("div",null," ")},J=function(t){M(r,e.Component);var n=Y(r);function r(t){var o;return O(this,r),q(P(o=n.call(this,t)),"getSyncComponent",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if("object Object"===Object.prototype.toString.call(t).slice(1,-1)){if(G(t))return t;t.__esModule&&(t=o.getSyncComponent(t.default,e))}else if("object Function"===Object.prototype.toString.call(t).slice(1,-1))t=t(o.props),t=o.getSyncComponent(t,e);else if("object Promise"===Object.prototype.toString.call(t).slice(1,-1))return o.resolveComponent(t,e).then((function(t){e(t)})),null;return t})),q(P(o),"resolveComponent",function(){var t,e=(t=a.default.mark((function t(e){var n,r=arguments;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:function(){},"object Promise"!==Object.prototype.toString.call(e).slice(1,-1)){t.next=10;break}return t.next=4,e;case 4:return e=t.sent,t.next=7,o.resolveComponent(e,n);case 7:e=t.sent,t.next=11;break;case 10:e=o.getSyncComponent(e,n);case 11:return t.abrupt("return",e);case 12:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function c(t){U(i,r,o,c,a,"next",t)}function a(t){U(i,r,o,c,a,"throw",t)}c(void 0)}))});return function(t){return e.apply(this,arguments)}}()),q(P(o),"getComponent",(function(){var t,n,r=o.state,i=r.AsynComponent,a=r.locationKey,u=r.match,l=o.props.children,f=o.context,s=f.history,p=void 0===s?{}:s,y=f.location,d=void 0===y?{}:y,m=f.routesComponent,h=void 0===m?[]:m,v=d.key;if(!Object.keys(o.context).length)throw new Error(W(!1,"You should not use <Switch/> outside a <Router>"));if(v===a)return c.default.createElement(F.Provider,{value:{history:p,location:d,match:u}},c.default.createElement(i,{match:u,history:p,location:d,exact:u.isExact,routesComponent:h}));var b=null,g=null;return e.Children.forEach(l,(function(t){if(null===b){var e=t.props,n=e.path,r=e.exact,i=e.strict,c=e.sensitive,a=e.from,u=e.component,l=e.element,f=e.render,s=n||a;u=u||l||f,(b=C(d.pathname,{path:s,exact:r,strict:i,sensitive:c}))&&(g=o.getSyncComponent(u,(function(t){o.setState({isSync:!1,AsynComponent:t,match:b,locationKey:v})})),g&&o.setState({isSync:!0,AsynComponent:g,match:b,locationKey:v}))}})),g?c.default.createElement(F.Provider,{value:{history:p,location:d,match:b}},c.default.createElement(g,{match:b,history:p,location:d,exact:null===(t=b)||void 0===t?void 0:t.isExact,routesComponent:h})):c.default.createElement(F.Provider,{value:{history:p,location:d,match:b}},c.default.createElement(i,{match:b,history:p,location:d,exact:null===(n=b)||void 0===n?void 0:n.isExact,routesComponent:h}))})),o.state={AsynComponent:H,locationKey:"",match:null,isSync:!0},o}return A(r,[{key:"componentDidMount",value:function(){var t=this.context.loading;t&&this.setState({AsynComponent:t})}},{key:"render",value:function(){return this.getComponent()}}]),r}();function Q(){return Q=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Q.apply(this,arguments)}function X(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=I(t);if(e){var o=I(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return T(this,n)}}J.contextType=D,J.propTypes={children:i.default.oneOfType([i.default.arrayOf(i.default.node),i.default.node]).isRequired};exports.MatchContext=F,exports.Route=E,exports.Router=K,exports.Switch=J,exports.__RouterContext=D,exports.isValidElementType=G,exports.lazy=y,exports.matchPath=C,exports.preloadReady=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=[],o=s(y.loaderArr);try{for(o.s();!(t=o.n()).done;){var i=t.value;r.push(i())}}catch(t){o.e(t)}finally{o.f()}return Promise.all(r).then((function(){e()})).catch((function(t){throw n(t),new Error(t)}))},exports.withRouter=function(t){var n="withRouter("+(t.displayName||t.name)+")",r=function(r){M(i,e.Component);var o=X(i);function i(){return O(this,i),o.apply(this,arguments)}return A(i,[{key:"render",value:function(){var r=this;return e.createElement(F.Consumer,null,(function(e){return e||W(!1,"You should not use <"+n+" /> outside a <Switch>"),c.default.createElement(t,Q({},e,r.props))}))}}]),i}();return r.displayName=n,r.WrappedComponent=t,u.default(r,t)};
